# test_final_integration.py
#!/usr/bin/env python3
"""
–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
"""

import sys
import os

PROJECT_ROOT = '/home/spirit/Desktop/project'
sys.path.insert(0, PROJECT_ROOT)

def test_web_imports():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–º–ø–æ—Ä—Ç—ã –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
    print("üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å...")
    
    try:
        from web.app import main, init_session_state
        print("‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: {e}")
        return False

def test_ml_system():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º ML —Å–∏—Å—Ç–µ–º—É"""
    print("\nüîç –¢–µ—Å—Ç–∏—Ä—É–µ–º ML —Å–∏—Å—Ç–µ–º—É...")
    
    try:
        from ml.core.system import SimpleNeuralSystem
        system = SimpleNeuralSystem()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
        status = system.get_status()
        predictions = system.predict(top_k=5)
        
        print("‚úÖ ML —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
        print(f"   - –°—Ç–∞—Ç—É—Å: {status['is_trained']}")
        print(f"   - –ü—Ä–æ–≥–Ω–æ–∑—ã: {len(predictions)}")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ ML —Å–∏—Å—Ç–µ–º—ã: {e}")
        return False

def test_services():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å—ã"""
    print("\nüîç –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å—ã...")
    
    try:
        from services.auto_learning.service import AutoLearningService
        from services.monitoring.service_runner import main as runner_main
        
        service = AutoLearningService()
        status = service.get_service_status()
        
        print("‚úÖ –°–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
        print(f"   - –°–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–µ–Ω: {status['service_active']}")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤: {e}")
        return False

if __name__ == "__main__":
    print("üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢ –°–ò–°–¢–ï–ú–´")
    print("=" * 50)
    
    success1 = test_web_imports()
    success2 = test_ml_system()
    success3 = test_services()
    
    print("\n" + "=" * 50)
    if success1 and success2 and success3:
        print("üéâ –í–°–ï –°–ò–°–¢–ï–ú–´ –†–ê–ë–û–¢–ê–Æ–¢ –ö–û–†–†–ï–ö–¢–ù–û!")
        print("\nüìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:")
        print("   ‚Ä¢ web/ - Streamlit –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
        print("   ‚Ä¢ ml/ - –º–æ–¥—É–ª—å–Ω–∞—è ML —Å–∏—Å—Ç–µ–º–∞") 
        print("   ‚Ä¢ services/ - –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å –∏ Telegram –±–æ—Ç")
        print("   ‚Ä¢ config/ - –µ–¥–∏–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è")
        print("   ‚Ä¢ data/ - –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
    else:
        print("‚ùå –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Å–∏—Å—Ç–µ–º–µ")
        sys.exit(1)